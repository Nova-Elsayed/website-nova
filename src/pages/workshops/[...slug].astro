---
import { contentfulClient } from "../../lib/contentful";
import type { Workshop } from "../../lib/contentful";
import WorkshopLayout from "../../layouts/WorkshopLayout.astro";
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import { slugify } from "@/lib/utils/textConverter";

export const prerender = true;

export async function getStaticPaths() {
  const entries = await contentfulClient.getEntries<Workshop>({
    content_type: "workshop",
  });

  const pages = entries.items.map((item) => ({
    params: { slug: slugify(item.fields.title) },
    props: {
      slug: slugify(item.fields.title),
      title: item.fields.title,
      headline: item.fields.headline,
      description: item.fields.description,
      location: item.fields.location,
      dateStart: item.fields.dateStart,
      dateEnd: item.fields.dateEnd,
      parentTitle: item.fields.parentTitle,
      parentURL: item.fields.parentURL,
    },
  }));
  return pages;
}

const {
  slug,
  title,
  headline,
  description,
  location,
  dateStart,
  dateEnd,
  parentTitle,
  parentURL,
} = Astro.props;
---

<WorkshopLayout
  description={description ? documentToHtmlString(description) : ""}
  title={title}
  slug={slug}
/>
